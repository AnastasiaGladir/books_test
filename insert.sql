INSERT INTO Authors (first_name, last_name)
VALUES
    ('Лев', 'Толстой'),
    ('Фёдор', 'Достоевский'),
    ('Иван', 'Тургенев'),
    ('Николай', 'Гоголь'),
    ('Александр', 'Пушкин'),
    ('Михаил', 'Лермонтов'),
    ('Иван', 'Гончаров'),
    ('Антон', 'Чехов'),
    ('Михаил', 'Булгаков'),
    ('Борис', 'Пастернак'),
    ('Михаил', 'Шолохов'),
    ('Джеймс', 'Джойс'),
    ('Джером', 'Сэлинджер'),
    ('Фрэнсис', 'Фицджеральд'),
    ('Джейн', 'Остин'),
    ('Шарлотта', 'Бронте'),
    ('Герман', 'Мелвилл'),
    ('Агата', 'Кристи'),
    ('Артур', 'Конан Дойл'),
    ('Льюис', 'Кэрролл'),
    ('Джеймс', 'Барри'),
    ('Алан', 'Милн'),
    ('Памела', 'Трэверс'),
    ('Астрид', 'Линдгрен'),
    ('Антуан', 'де Сент-Экзюпери'),
    ('Джоан', 'Роулинг'),
    ('Фрэнк', 'Герберт'),
    ('Рэй', 'Брэдбери'),
    ('Герберт', 'Уэллс'),
    ('Клайв', 'Льюис'),
    ('Джон', 'Толкин'),
    ('Орсон', 'Скотт Кард'),
    ('Уильям', 'Гибсон'),
    ('Ганс', 'Христиан Андерсен'),
    ('Марк', 'Твен'),
    ('Роберт', 'Стивенсон'),
    ('Даниель', 'Дефо'),
    ('Джонатан', 'Свифт');

INSERT INTO Publishers (name)
VALUES
    ('АСТ'),
    ('Эксмо');


INSERT INTO Genres (name)
VALUES
    ('Классическая литература'),
    ('Фантастика'),
   ('Детская литература'),
   ('Детектив');

-- Заполнение таблицы Warehouses тестовыми данными
INSERT INTO Warehouses (name, address, capacity)
VALUES
    ('Основной склад', 'ул. Ленина, 1', 10000),
    ('Склад №2', 'ул. Мира, 15', 5000),
    ('Дополнительный склад', 'пер. Зелёный, 7', 2500),
    ('Центральный склад', 'пр. Победы, 42', 7500),
    ('Склад "Книголюб"', 'ул. Пушкина, 2', 3000),
    ('Склад "Знание"', 'ул. Университетская, 1', 2000),
    ('Склад "Литература"', 'наб. Речная, 9', 4000),
    ('Склад "Бестселлер"', 'пл. Центральная, 3', 6000),
    ('Склад "Детский мир"', 'ул. Сказочная, 5', 1500),
    ('Склад "Фантазия"', 'ул. Космическая, 8', 3500);

INSERT INTO Books (title, author_id, publisher_id, genre_id, price, publication_date, isbn, warehouse_id) VALUES
('Война и мир', 1, 1, 1, 1500.00, '1869-01-01', '978-5-699-12345-6', 1),
('Анна Каренина', 1, 1, 1, 1200.00, '1877-01-01', '978-5-699-12346-3', 1),
('Преступление и наказание', 2, 2, 1, 1000.00, '1866-01-01', '978-5-17-12345-7', 2),
('Идиот', 2, 2, 1, 1100.00, '1869-01-01', '978-5-17-12346-4', 1),
('Братья Карамазовы', 2, 2, 1, 1300.00, '1880-01-01', '978-5-17-12347-1', 1),
('Отцы и дети', 3, 1, 1, 900.00, '1862-01-01', '978-5-699-12347-0', 3),
('Дворянское гнездо', 3, 1, 1, 850.00, '1859-01-01', '978-5-699-12348-7', 5),
('Мёртвые души', 4, 2, 1, 950.00, '1842-01-01', '978-5-17-12348-8', 1),
('Ревизор', 4, 2, 1, 800.00, '1836-01-01', '978-5-17-12349-5', 1),
('Евгений Онегин', 5, 1, 1, 700.00, '1833-01-01', '978-5-699-12349-4', 1),
('Капитанская дочка', 5, 1, 1, 750.00, '1836-01-01', '978-5-699-12350-0', 1),
('Герой нашего времени', 6, 2, 1, 850.00, '1840-01-01', '978-5-17-12350-1', 4),
('Обломов', 7, 1, 1, 900.00, '1859-01-01', '978-5-699-12351-7', 3),
('Вишнёвый сад', 8, 2, 1, 600.00, '1904-01-01', '978-5-17-12351-8', 1),
('Три сестры', 8, 2, 1, 650.00, '1901-01-01', '978-5-17-12352-5', 4),
('Чайка', 8, 2, 1, 620.00, '1896-01-01', '978-5-17-12353-2', 1),
('Мастер и Маргарита', 9, 1, 1, 1400.00, '1967-01-01', '978-5-699-12352-4', 2),
('Собачье сердце', 9, 1, 1, 800.00, '1925-01-01', '978-5-699-12353-1', 1),
('Доктор Живаго', 10, 2, 1, 1100.00, '1957-01-01', '978-5-17-12354-9', 1),
('Тихий Дон', 11, 1, 1, 1300.00, '1928-01-01', '978-5-699-12354-8', 1),
('Улисс', 12, 1, 1, 1600.00, '1922-02-02', '978-5-699-12355-5', 1),
('Над пропастью во ржи', 13, 2, 1, 900.00, '1951-07-16', '978-5-17-12357-0', 8),
('Великий Гэтсби', 14, 1, 1, 850.00, '1925-04-10', '978-5-699-12356-2', 6),
('Гордость и предубеждение', 15, 2, 1, 750.00, '1813-01-28', '978-5-17-12358-7', 1),
('Джейн Эйр', 16, 1, 1, 800.00, '1847-10-16', '978-5-699-12357-9', 1),
('Моби Дик', 17, 2, 1, 950.00, '1851-10-18', '978-5-17-12359-4', 1),
('Убийство в Восточном экспрессе', 18, 2, 3, 850.00, '1934-01-01', '978-5-17-12370-9', 1),
('Десять негритят', 18, 2, 3, 900.00, '1939-01-01', '978-5-17-12371-6', 1),
('Собака Баскервилей', 19, 1, 3, 800.00, '1902-01-01', '978-5-699-12367-8', 5),
('Знак четырёх', 19, 1, 3, 750.00, '1890-01-01', '978-5-699-12368-5', 1),
('Убийство Роджера Экройда', 18, 2, 3, 870.00, '1926-01-01', '978-5-17-12372-3', 1),
('Приключения Шерлока Холмса', 19, 1, 3, 950.00, '1892-01-01', '978-5-699-12369-2', 1),
('Алиса в Стране чудес', 20, 2, 4, 600.00, '1865-01-01', '978-5-17-12373-0', 1),
('Алиса в Зазеркалье', 20, 2, 4, 620.00, '1871-01-01', '978-5-17-12374-7', 1),
('Питер Пэн', 21, 1, 4, 550.00, '1911-01-01', '978-5-699-12370-8', 9),
('Винни-Пух', 22, 2, 4, 500.00, '1926-01-01', '978-5-17-12375-4', 10),
('Мэри Поппинс', 23, 1, 4, 650.00, '1934-01-01', '978-5-699-12371-5', 10),
('Карлсон, который живёт на крыше', 24, 2, 4, 700.00, '1955-01-01', '978-5-17-12376-1', 10),
('Маленький принц', 25, 1, 4, 750.00, '1943-01-01', '978-5-699-12372-2', 10),
('Гарри Поттер и философский камень', 26, 2, 4, 1200.00, '1997-06-26', '978-5-17-12377-8', 10),
('Гарри Поттер и Тайная комната', 26, 2, 4, 1250.00, '1998-07-02', '978-5-17-12378-5', 2),
('Гарри Поттер и узник Азкабана', 26, 2, 4, 1300.00, '1999-07-08', '978-5-17-12379-2', 4),
('Дюна', 27, 1, 2, 1400.00, '1965-01-01', '978-5-699-12373-9', 7),
('451 градус по Фаренгейту', 28, 2, 2, 900.00, '1953-01-01', '978-5-17-12380-8', 8),
('Машина времени', 29, 1, 2, 800.00, '1895-01-01', '978-5-699-12374-6', 9),
('Война миров', 29, 1, 2, 850.00, '1898-01-01', '978-5-699-12375-3', 7),
('Хроники Нарнии', 30, 2, 2, 1100.00, '1950-01-01', '978-5-17-12381-5', 3),
('Властелин колец: Братство Кольца', 31, 1, 2, 1500.00, '1954-07-29', '978-5-699-12376-0', 2),
('Властелин колец: Две крепости', 31, 1, 2, 1550.00, '1954-11-11', '978-5-699-12377-7', 2),
('Властелин колец: Возвращение короля', 31, 1, 2, 1600.00, '1955-10-20', '978-5-699-12378-4', 5),
('Игра Эндера', 32, 2, 2, 950.00, '1985-01-01', '978-5-17-12382-2', 5),
('Нейромант', 33, 1, 2, 1000.00, '1984-01-01', '978-5-699-12379-1', 8),
('Снежная королева', 34, 2, 4, 600.00, '1844-01-01', '978-5-17-12383-9', 3),
('Приключения Тома Сойера', 35, 1, 4, 700.00, '1876-01-01', '978-5-699-12380-7', 5),
('Приключения Гекльберри Финна', 35, 1, 4, 720.00, '1884-01-01', '978-5-699-12381-4', 6),
('Остров сокровищ', 36, 2, 4, 750.00, '1883-01-01', '978-5-17-12384-6', 7),
('Робинзон Крузо', 37, 1, 4, 680.00, '1719-01-01', '978-5-699-12382-1', 8),
('Путешествия Гулливера', 38, 2, 4, 700.00, '1726-01-01', '978-5-17-12385-3', 6);
-- Функция для генерации случайного числа в заданном диапазоне
CREATE OR REPLACE FUNCTION random_between(low INT ,high INT)
   RETURNS INT AS
$$
BEGIN
   RETURN  floor(random() * (high-low + 1) + low);
END;
$$ LANGUAGE plpgsql;

-- Функция для генерации случайной строки (только цифры)
CREATE OR REPLACE FUNCTION random_digits(length INTEGER)
RETURNS TEXT AS $$
DECLARE
  chars TEXT := '0123456789';
  str TEXT := '';
  i INTEGER := 0;
  chars_length INTEGER := length(chars);
  random_pos INTEGER;
BEGIN
  IF length < 0 THEN
    RAISE EXCEPTION 'Given length cannot be less than 0';
  END IF;
  str := '';
  FOR i IN 1..length LOOP
    random_pos := floor(random() * chars_length + 1);
    str := str || substring(chars FROM random_pos FOR 1);
  END LOOP;
  RETURN str;
END;
$$ LANGUAGE plpgsql;

-- Функция для генерации случайной строки (буквы и цифры)
CREATE OR REPLACE FUNCTION random_string(length INTEGER)
RETURNS TEXT AS $$
DECLARE
  chars TEXT := 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
  str TEXT := '';
  i INTEGER := 0;
  chars_length INTEGER := length(chars);
  random_pos INTEGER;
BEGIN
  IF length < 0 THEN
    RAISE EXCEPTION 'Given length cannot be less than 0';
  END IF;
  str := '';
  FOR i IN 1..length LOOP
    random_pos := floor(random() * chars_length + 1);
    str := str || substring(chars FROM random_pos FOR 1);
  END LOOP;
  RETURN str;
END;
$$ LANGUAGE plpgsql;


-- Заполнение таблицы Customers 100 случайными кортежами
DO $$
DECLARE
  i INTEGER;
  male_first_names TEXT[] := ARRAY['Алексей', 'Борис', 'Василий', 'Дмитрий', 'Иван', 'Михаил', 'Сергей', 'Андрей', 'Павел', 'Евгений', 'Артем', 'Роман', 'Никита', 'Владислав', 'Кирилл', 'Максим', 'Олег', 'Игорь', 'Станислав', 'Григорий'];
  female_first_names TEXT[]:=ARRAY['Анна', 'Елена', 'Ольга', 'Наталья', 'Ирина', 'Светлана', 'Юлия', 'Мария', 'Татьяна', 'Екатерина'];
  male_last_names TEXT[] := ARRAY['Алексеев', 'Борисов', 'Васильев', 'Дмитриев', 'Иванов', 'Михайлов', 'Сергеев', 'Андреев', 'Павлов', 'Евгеньев', 'Артемьев', 'Романов', 'Никитин', 'Владиславов', 'Кириллов', 'Максимов', 'Олегов', 'Игорев', 'Станиславов', 'Григорьев'];
  female_last_names TEXT[]:= ARRAY['Смирнова', 'Иванова', 'Кузнецова', 'Попова', 'Васильева', 'Петрова', 'Соколова', 'Михайлова', 'Новикова', 'Федорова'];
    street_names TEXT[] := ARRAY['Ленина', 'Мира', 'Пушкина', 'Лермонтова', 'Гагарина', 'Советская', 'Молодежная', 'Школьная', 'Садовая', 'Центральная'];
    city_names TEXT[] := ARRAY['Москва', 'Санкт-Петербург', 'Казань', 'Екатеринбург', 'Новосибирск', 'Самара', 'Нижний Новгород', 'Ростов-на-Дону', 'Уфа', 'Красноярск'];
    is_male BOOLEAN;
    first_name TEXT;
    last_name TEXT;

BEGIN
  FOR i IN 1..100 LOOP

  is_male:= (random() < 0.5 );
  IF is_male THEN
    first_name := male_first_names[ random_between(1, array_length(male_first_names, 1))];
    last_name := male_last_names[ random_between (1, array_length(male_last_names, 1))];
    ELSE
      first_name := female_first_names[random_between(1, array_length(female_first_names, 1))];
      last_name := female_last_names[random_between(1, array_length(female_last_names, 1))];
    END IF;

    INSERT INTO Customers (first_name, last_name, email, phone, address)
    VALUES (
      first_name, -- Случайное имя
      last_name,  -- Случайная фамилия
      lower(random_string(8) || '@example.com'), -- Случайный email
      '+7' || random_digits(10), -- Случайный телефон (только цифры)
      'ул. ' || street_names[random_between(1, array_length(street_names, 1))] || ', д. ' || random_between(1, 100) || ', кв. ' || random_between(1, 50) || ', ' || city_names[random_between(1, array_length(city_names, 1))] -- Более осмысленный адрес
    );
  END LOOP;
END $$;
-- Функция для генерации случайного текста комментария
CREATE OR REPLACE FUNCTION random_comment(max_words INT)
RETURNS TEXT AS $$
DECLARE
  words TEXT[] := ARRAY['отлично', 'хорошо', 'неплохо', 'ужасно', 'великолепно', 'интересно', 'скучно', 'захватывающе', 'рекомендую', 'не советую', 'потрясающе', 'замечательно', 'средне', 'увлекательно', 'интригующе', 'разочарован', 'восторг', 'уныло', 'гениально', 'просто', 'сложно', 'динамично', 'монотонно', 'неожиданно', 'предсказуемо'];
  comment TEXT := '';
  num_words INTEGER := random_between(1, max_words);
  i INTEGER;
BEGIN
  FOR i IN 1..num_words LOOP
    comment := comment || words[random_between(1, array_length(words, 1))] || ' ';
  END LOOP;
  RETURN trim(comment);
END;
$$ LANGUAGE plpgsql;

-- Заполнение таблицы Reviews 100 случайными кортежами
DO $$
DECLARE
  i INTEGER;
  book_count INTEGER;
  customer_count INTEGER;
  book_id_array INTEGER[];
  customer_id_array INTEGER[];
BEGIN
  -- Получаем массивы book_id и customer_id
  SELECT array_agg(book_id) INTO book_id_array FROM Books;
  SELECT array_agg(customer_id) INTO customer_id_array FROM Customers;

  book_count := array_length(book_id_array, 1);
  customer_count := array_length(customer_id_array, 1);

  FOR i IN 1..100 LOOP
    INSERT INTO Reviews (book_id, customer_id, rating, comment, review_date)
    VALUES (
      book_id_array[random_between(1, book_count)], -- Случайный book_id
      customer_id_array[random_between(1, customer_count)], -- Случайный customer_id
      random_between(1, 5), -- Случайный рейтинг от 1 до 5
      random_comment(15), -- Случайный комментарий (до 15 слов)
      random_date('2023-01-01', '2023-12-31')  -- Случайная дата отзыва в 2023 году
    );
  END LOOP;
END $$;

-- Заполнение таблицы Departments
INSERT INTO Departments (name)
VALUES
    ('Продажи'),
    ('Маркетинг'),
    ('Разработка'),
    ('Бухгалтерия'),
    ('HR'),
    ('IT'),
    ('Юридический'),
    ('Логистика'),
    ('Поддержка'),
    ('Аналитика');

    -- Заполнение таблицы Employees 100 случайными кортежами
    DO $$
    DECLARE
      i INTEGER;
      department_count INTEGER;
      department_id_array INTEGER[];
      male_first_names TEXT[] := ARRAY['Алексей', 'Борис', 'Василий', 'Дмитрий', 'Иван', 'Михаил', 'Сергей', 'Андрей', 'Павел', 'Евгений', 'Артем', 'Роман', 'Никита', 'Владислав', 'Кирилл', 'Максим', 'Олег', 'Игорь', 'Станислав', 'Григорий'];
      female_first_names TEXT[] := ARRAY['Анна', 'Елена', 'Ольга', 'Наталья', 'Ирина', 'Светлана', 'Юлия', 'Мария', 'Татьяна', 'Екатерина'];
      male_last_names TEXT[] := ARRAY['Алексеев', 'Борисов', 'Васильев', 'Дмитриев', 'Иванов', 'Михайлов', 'Сергеев', 'Андреев', 'Павлов', 'Евгеньев', 'Артемьев', 'Романов', 'Никитин', 'Владиславов', 'Кириллов', 'Максимов', 'Олегов', 'Игорев', 'Станиславов', 'Григорьев'];
      female_last_names TEXT[] := ARRAY['Смирнова', 'Иванова', 'Кузнецова', 'Попова', 'Васильева', 'Петрова', 'Соколова', 'Михайлова', 'Новикова', 'Федорова'];
      is_male BOOLEAN;
      first_name TEXT;
      last_name TEXT;

    BEGIN
      -- Получаем массив всех department_id
      SELECT array_agg(department_id) INTO department_id_array FROM Departments;
      department_count := array_length(department_id_array, 1);

      FOR i IN 1..100 LOOP
        -- Случайно определяем пол
        is_male := (random() < 0.5);

        -- Выбираем имя и фамилию в зависимости от пола
        IF is_male THEN
          first_name := male_first_names[random_between(1, array_length(male_first_names, 1))];
          last_name := male_last_names[random_between(1, array_length(male_last_names, 1))];
        ELSE
          first_name := female_first_names[random_between(1, array_length(female_first_names, 1))];
          last_name := female_last_names[random_between(1, array_length(female_last_names, 1))];
        END IF;

        INSERT INTO Employees (first_name, last_name, department_id, hire_date, salary)
        VALUES (
          first_name, -- Случайное имя (в зависимости от пола)
          last_name,  -- Случайная фамилия (в зависимости от пола)
          department_id_array[random_between(1, department_count)], -- Случайный department_id из массива
          random_date('2018-01-01', '2024-12-31'),  -- Случайная дата найма
          round((random() * 150000 + 50000)::NUMERIC, 2)  -- Случайная зарплата (от 50000 до 200000)
        );
      END LOOP;
    END $$;
